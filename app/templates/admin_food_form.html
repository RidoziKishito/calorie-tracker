{% extends "admin_base.html" %}
{% block title %}{{ 'Chỉnh sửa' if food else 'Thêm mới' }} món ăn{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h4 class="fw-bold mb-0">{{ 'Chỉnh sửa' if food else 'Thêm mới' }} món ăn</h4>
    <a href="/admin/foods" class="btn btn-light rounded-circle shadow-sm"><i class="fa-solid fa-xmark"></i></a>
</div>

<div class="card border-0 shadow-sm rounded-xl p-4">
    <form action="{{ '/admin/foods/update' if food else '/admin/foods/create' }}" method="POST">
        <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
        {% if food %}
        <input type="hidden" name="id" value="{{ food.id }}">
        {% endif %}

        <div class="row g-3">
            <div class="col-md-6">
                <label class="form-label">Tên món ăn <span class="text-danger">*</span></label>
                <input type="text" class="form-control" name="name" value="{{ food.name if food else '' }}" required>
            </div>

            <div class="col-md-6">
                <label class="form-label">AI Label (Slug)</label>
                <input type="text" class="form-control" name="ai_slug"
                    value="{{ food.ai_slug if food and food.ai_slug else '' }}" placeholder="VD: pho_bo">
                <small class="text-muted">Dùng để khớp với model AI</small>
            </div>

            <div class="col-12">
                <label class="form-label">Ảnh URL</label>
                <input type="url" class="form-control" name="image_url"
                    value="{{ food.image_url if food and food.image_url else '' }}"
                    placeholder="https://example.com/image.jpg">
            </div>

            <div class="col-md-3">
                <label class="form-label">Calo (kcal) <span class="text-danger">*</span></label>
                <input type="number" class="form-control" name="calories" value="{{ food.calories if food else '' }}"
                    required>
            </div>

            <div class="col-md-3">
                <label class="form-label">Đơn vị tính</label>
                <select class="form-select" name="unit">
                    {% set u = food.unit if food else 'phần' %}
                    <option value="phần" {% if u=='phần' %}selected{% endif %}>Phần</option>
                    <option value="tô" {% if u=='tô' %}selected{% endif %}>Tô</option>
                    <option value="chén" {% if u=='chén' %}selected{% endif %}>Chén</option>
                    <option value="dĩa" {% if u=='dĩa' %}selected{% endif %}>Dĩa</option>
                    <option value="miếng" {% if u=='miếng' %}selected{% endif %}>Miếng</option>
                    <option value="ly" {% if u=='ly' %}selected{% endif %}>Ly</option>
                </select>
            </div>

            <div class="col-md-2">
                <label class="form-label">Carbs (g)</label>
                <input type="number" class="form-control" name="carbs" value="{{ food.carbs if food else 0 }}"
                    step="0.1">
            </div>
            <div class="col-md-2">
                <label class="form-label">Protein (g)</label>
                <input type="number" class="form-control" name="protein" value="{{ food.protein if food else 0 }}"
                    step="0.1">
            </div>
            <div class="col-md-2">
                <label class="form-label">Fat (g)</label>
                <input type="number" class="form-control" name="fat" value="{{ food.fat if food else 0 }}" step="0.1">
            </div>
        </div>

        <div class="mt-4 text-end">
            <button type="submit" class="btn btn-primary rounded-pill px-5">
                <i class="fa-solid fa-save me-2"></i>Lưu
            </button>
        </div>
    </form>
</div>
{% endblock %}